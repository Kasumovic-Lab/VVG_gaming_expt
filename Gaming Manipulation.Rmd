ANALYZING THE EFFECT OF VIOLENT VIDEO GAME PLAY ON MATE VALUE AND OTHER MATING RELATED VARIABLES
========================================================

General housekeeping
--------------------

First load the libraries that we are using
```{r}
library(ggplot2)
library(knitr)
library(QuantPsyc)
library(PerformanceAnalytics)
library(heplots)
library(plyr)
require(gridExtra)
library(lattice)
```

Load the data (Complete_data_survey.csv).
Note the as.is thing which leaves all the character vectors as strings and does not make them into factors.

```{r}
data = read.csv(file.choose(),  na.strings =".", header=T, sep=",")
```

Attach and check the headers of each column

```{r}
names(data)
```

Recode gender into numerical values

```{r}
data$Gender2 <- revalue(data$Gender, c("Male"="1", "Female"="2"))
data$Gender2 <- as.numeric(as.character(data$Gender2))
```

Ensuring that certain columns are treated as categorical

```{r}
data$Sexuality <- factor(data$Sexuality)
data$soirq1_response <- factor(data$soirq1)
data$soirq2_response <- factor(data$soirq2)
data$soirq3_response <- factor (data$soirq3)
```


Delete Rows where participants were unable to load or play game, or remember score, or have recorded gender as "Other".

```{r}
data<-data[-which(data$Removedata == ""), ]
data<-data[-which(data$Gender == "Other"), ]
```


Remove individuals that have a relationship status of 'other' (2 individuals)

```{r}
data = subset(data, Relationshipstatus %in% c("Single", "In an open relationship/casually dating", "In a long-term monogamous relationship eg. married, partnered", "Recently single/divorced/separated"))
```

Here's mean centring the data
```{r}
data$mc_MV1Total <- scale(data$MV1Total, center = TRUE, scale = TRUE)
data$mc_SOIRTOTAL <- scale(data$SOIRTOTAL, center = TRUE, scale = TRUE)
data$mc_MV2Average <- scale(data$MV2Average, center = TRUE, scale = TRUE)
data$mc_SGAAverage <- scale(data$SGAAverage, center = TRUE, scale = TRUE)
data$mc_HostilityTotal <- scale(data$HostilityTotal, center = TRUE, scale = TRUE)
data$mc_MMTotal <- scale(data$MMTotal, center = TRUE, scale = TRUE)
```

---------------

What is the mean, SD and range of the age of respondents in the first sample?
```{r}
mean(data$Age)
sd(data$Age)
range(data$Age)
```


Do men and women differ in the amount of violent video games they play (self-rated)

```{r}
VVGSex <- lm(Averagefrequencyviolence ~  Age + Gender + Age*Gender, data = data)
anova(VVGSex, test="Chisq")
summary(VVGSex, test="Chisq")
```
HISTOGRAM
```{r}
hist1 <- ggplot(data, aes(x=Averagefrequencyviolence, fill=Gender)) + 
  geom_histogram(binwidth=2, position="dodge") +
  xlab("Self-rated Violence Exposure") +
  ylab("Count") +
  scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
  theme(axis.line = element_line(colour = "black"),
        plot.title = element_text(size=30, face="bold"),
        legend.position = "none",
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 

hist1
```

Plot to see it. Boxplot of VVGplay between gender (Self-reported)

```{r}
BoxVVGgender <- ggplot(data, aes(x=Gender, y=Averagefrequencyviolence)) + geom_boxplot() + 
  guides(fill=FALSE) + 
  xlab("Gender") +
  ylab("Self-Rated Violence Exposure") +
  theme(axis.line = element_line(colour = "black"),
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 

BoxVVGgender 
```


Here is the full model

```{r}
VGplayselfall<-lm(Averagefrequencyviolence~ MV1Total + MV2Average + SOIRTOTAL + SGAAverage + HostilityTotal + MATINGMOTIVATIONTotal + Gender + Sexuality + Age + Relationshipstatus + VorNV + Gender*MV1Total + Gender*SOIRtotal + Gender*MV2Average + Gender*HostilityTotal + Gender*MATINGMOTIVATIONTotal + Gender*Sexuality + Gender*Relationshipstatus, data=data)

anova(VGplayselfall, test="typeIII")
summary(VGplayselfall)
```

calculate r-squared for relationship between SOI & MV with VVGExposure

```{r}
cor.test(data$Averagefrequencyviolence,data$SOIRTOTAL)

data.fem = subset(data, Gender=="Female")
cor.test(data.fem$Averagefrequencyviolence,data.fem$MV1)

data.mal = subset(data, Gender=="Male")
cor.test(data.mal$Averagefrequencyviolence,data.mal$MV1)

```
22 Item MV scale and VVG for each gender regression
```{r}
fit <- lm(MV2Average ~ Averagefrequencyviolence + Gender, data=data)
summary(fit) 
```
Plot Mate Value and VVGplay for each gender - 22 item mv scale

```{r}
plotMvAverage <- ggplot(data, aes(x = MV2Average, y = Averagefrequencyviolence, color = Gender, shape = Gender, linetype = Gender)) + 
  geom_point(size = 4) + 
  ylim(0,50) +
  scale_colour_hue(l=50, guide = FALSE) +
  scale_x_continuous(limits=c(0.5,7.5), breaks=c(1:7)) +
  theme_bw() + geom_smooth(method=lm,  fullrange=T) + 
  xlab("Mate Value") +
  ylab("Violent Video Game Exposure") +
  theme(legend.position="none") +
  theme(axis.line = element_line(colour = "black"),
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        axis.title.y=element_text(vjust=0.25),
        axis.title.x=element_text(vjust=0.25),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 
plotMvAverage
```
MVScaletotal and vvgplay regression
```{r}
fitMV1 <- lm(MV1Total ~ Averagefrequencyviolence + Gender, data=data)
summary(fitMV1) 
```

Plot with MVscaletotal - 4 general MV questions 
```{r}
ggplot(data, aes(x = MV1Total, y = Selfscore, color = Gender)) + 
  geom_point(size = 4) + 
 # ylim(0,50) +
  scale_colour_hue(l=50, guide = FALSE) +
  theme_bw() + geom_smooth(method=lm,  fullrange=T) + 
  xlab("Mate Value") +
  ylab("Violent Video Game Exposure") +
  theme(legend.position="none") +
  theme(axis.line = element_line(colour = "black"),
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        axis.title.y=element_text(vjust=0.25),
        axis.title.x=element_text(vjust=0.25),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 
```

Now, plot both MV figures together
```{r}
grid.arrange(plotMV1, plotMV2, ncol=2)
g <- arrangeGrob(plotMV1, plotMV2, ncol=2)
ggsave(file="MateValue.tiff",g)
```

SOI + Averagefrequencyviolence+Gender Regression
```{r}
fitSOI <- lm(SOIRTOTAL ~ Averagefrequencyviolence + Gender, data=data)
summary(fitSOI)
```
Now plot SOI
```{r}
plotSOI1 <- ggplot(data, aes(x = SOIRTOTAL, y = Averagefrequencyviolence, color = Gender, shape = Gender, linetype = Gender)) + 
  geom_point(size=4) +
  ylim(0,50) +
  scale_colour_hue(l=50, guide = FALSE) +
  scale_x_continuous(limits=c(0,80)) +
  theme_bw() + geom_smooth(method=lm,  fullrange=T) + 
  xlab("Sexual Interest") +
  ylab("Violent Video Game Exposure") +
  theme(legend.position="none") +
  theme(axis.line = element_line(colour = "black"),
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        axis.title.y=element_text(vjust=0.25),
        axis.title.x=element_text(vjust=0.25),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 
plotSOI1
```

Matingmotivation Regression Avfreqviolence
```{r}
fitMM <- lm(MATINGMOTIVATIONtotal ~ Averagefrequencyviolence + Gender, data=data)
summary(fitMM) 
```

Now plot mating motivation
```{r}
ggplot(data, aes(x = MATINGMOTIVATIONtotal, y = Averagefrequencyviolence, color = Gender, shape = Gender, linetype = Gender)) + 
  geom_point(size=4) +
  theme_bw() + geom_smooth(method=lm, fullrange=T) + 
  scale_colour_hue(l=50, guide = FALSE) +
  ylim(0,50) +
  scale_x_continuous(limits=c(0.75,7.25), breaks=c(1:7)) +
  xlab("Gaming Motivation") +
  ylab("Violent Video Game Exposure") +
  theme(axis.line = element_line(colour = "black"),
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        axis.title.y=element_text(vjust=0.25),
        axis.title.x=element_text(vjust=0.25),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank(),
        legend.position=c(.90,.10)) 

```

*****************Gaming manipulation: *********************
MV1 + VVG + gender ANOVA*
```{r}
VorNVMV1 <- lm(MV1Total ~  VorNV + Age + Gender + Gender*Averagefrequencyviolence + VorNV*Gender + VorNV*Age + VorNV*Averagefrequencyviolence + Averagefrequencyviolence + Selfscore + Selfscore*Gender + Selfscore*Age + Numericalgameplayed +Numericalgameplayed*Gender + Numericalgameplayed*Age, data = data)
anova(VorNVMV1, test="Chisq")
```


MV2 + VVG + Gender ANOVA
```{r}
VorNVMV2 <- lm(MV2Average ~ VorNV + Age + Gender + Gender*Averagefrequencyviolence + VorNV*Gender + VorNV*Age + VorNV*Averagefrequencyviolence + Averagefrequencyviolence + Selfscore + Selfscore*Gender + Selfscore*Age + Numericalgameplayed +Numericalgameplayed*Gender + Numericalgameplayed*Age, data = data)
anova(VorNVMV2, test="Chisq")
```

MVfactorviewofoppositesex + Gender + VVG
```{r}
VorNVMVoppositesex <- lm(Mvfactorviewofoppositesex ~ VorNV + Age + Gender + Gender*Averagefrequencyviolence + VorNV*Gender + VorNV*Age + VorNV*Averagefrequencyviolence + Averagefrequencyviolence + Selfscore + Selfscore*Gender + Selfscore*Age + Numericalgameplayed +Numericalgameplayed*Gender + Numericalgameplayed*Age, data = data)
anova(VorNVMVoppositesex, test="Chisq")
```

GA + VVG + gender ANOVA
```{r}
SGAVVG <- lm(SGAAverage ~  VorNV + Age + Gender + Gender*Averagefrequencyviolence + VorNV*Gender + VorNV*Age + VorNV*Averagefrequencyviolence + Averagefrequencyviolence + Selfscore + Selfscore*Gender + Selfscore*Age + Numericalgameplayed +Numericalgameplayed*Gender + Numericalgameplayed*Age, data = data)
anova(SGAVVG, test="Chisq")
```

Hostility + VVG + gender ANOVA
```{r}
HostVVG <- lm(HostilityTotal ~  VorNV + Age + Gender + Gender*Averagefrequencyviolence + VorNV*Gender + VorNV*Age + VorNV*Averagefrequencyviolence + Averagefrequencyviolence + Selfscore + Selfscore*Gender + Selfscore*Age + Numericalgameplayed +Numericalgameplayed*Gender + Numericalgameplayed*Age, data = data)
anova(HostVVG, test="Chisq")
```

Matingmotivation + gender ANOVA + otherfactors

```{r}
MMANOVAVVG <- lm(MATINGMOTIVATIONtotal ~  VorNV + Age + Gender + Gender*Averagefrequencyviolence + VorNV*Gender + VorNV*Age + VorNV*Averagefrequencyviolence + Averagefrequencyviolence + Selfscore + Selfscore*Gender + Selfscore*Age + Numericalgameplayed +Numericalgameplayed*Gender + Numericalgameplayed*Age, data = data)
anova(MMANOVAVVG, test="Chisq")
```


MV Scale and Violent or NV game histogram: 

```{r}
histogram(~MV1Total|VorNV*Gender, data=data,
       type="MV",
       xlab="Gender",
       main="")
```

MV2 x V or Non V histogram
```{r}
ggplot(data, aes(x=VorNV, y=MV2Average, fill=Gender)) + 
  geom_histogram(binwidth=2, position="dodge") +
  xlab("Violent or Non-violent game played") +
  ylab("Mate Value Total") +
  scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
  theme(axis.line = element_line(colour = "black"),
        plot.title = element_text(size=30, face="bold"),
        legend.position = "none",
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 

```

Historgram for SGA and VorNV
```{r}
histvornvmv1 <- ggplot(data, aes(x=VorNV, y=SGAAverage, fill=Gender)) + 
  geom_histogram(binwidth=2, position="dodge") +
  xlab("Violent or Non-violent game played") +
  ylab("Sex Goal Activation") +
  scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
  theme(axis.line = element_line(colour = "black"),
        plot.title = element_text(size=30, face="bold"),
        legend.position = "none",
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 

histvornvSGA
```
Hostility and VorNVG histogram
```{r}
histvornvhos <- ggplot(data, aes(x=VorNV, y=HostilityTotal, fill=Gender)) + 
  geom_histogram(binwidth=2, position="dodge") +
  xlab("") +
  ylab("Mate Value Scale Total") +
  scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
  theme(axis.line = element_line(colour = "black"),
        plot.title = element_text(size=30, face="bold"),
        legend.position = "none",
        axis.text=element_text(size=18),
        axis.title=element_text(size=20,face="bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) 

histvornvhos
```

Supplementary Materials
-----------------------

Here is the full model with age and all the interactions for Mturk 1

```{r}
VGplayself.all.data<-lm(Averagefrequencyviolence ~ Mvscaletotal + MvAverage + SGAAverage+ HostilityTotal  + MATINGMOTIVATIONtotal + SOIRTOTAL + sexuality_response + sex_response + age_response + relationshipstatus_response +VorNV + sex_response*Mvscaletotal +sex_response**MvAverage +sex_response*sexuality_response +sex_response*relationshipstatus_response+ age_response*Mvscaletotal +age_response*MvAverage + age_response*SGAAverage + age_response*HostilityTotal + age_response*MATINGMOTIVATION_total +age_response*SOIRTOTAL + age_response*sexuality_response + age_response*relationshipstatus_response, data=mturk)

anova(VGplayself.all.mturk1, test="Chisq")
summary(VGplayself.all.mturk1)
```
